<div class="projects-container">
  <div class="projects-header">
    <h1>Projects</h1>
    <button class="create-btn" (click)="openCreateModal()" [disabled]="isLoading">
      <span class="btn-icon">â•</span>
      New Project
    </button>
  </div>

  <!-- Loading indicator -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner-large"></div>
    <p>Loading projects...</p>
  </div>

  <div class="projects-list" *ngIf="!isLoading && currentUser && currentUser.projects.length > 0">
    <div 
      class="project-card" 
      *ngFor="let project of currentUser.projects; let i = index"
      (click)="selectProject(i)"
    >
      <div class="project-card-header">
        <div class="project-title-section">
          <h2>{{ project.name }}</h2>
          <span class="project-type-badge" [class.local]="isLocalProject(project)" [class.hosted]="!isLocalProject(project)">
            {{ isLocalProject(project) ? 'ğŸ“ Local' : 'ğŸŒ Hosted' }}
          </span>
        </div>
        <button 
          class="delete-btn" 
          (click)="deleteProject(i, $event)"
          title="Delete project"
          [disabled]="isDeleting && deletingProjectIndex === i"
        >
          <span *ngIf="isDeleting && deletingProjectIndex === i" class="spinner-small"></span>
          <span *ngIf="!(isDeleting && deletingProjectIndex === i)">ğŸ—‘ï¸</span>
        </button>
      </div>
      <div class="project-stats">
        <span>{{ project.grid.length }} grids</span>
      </div>
    </div>
  </div>

  <div class="empty-projects" *ngIf="!isLoading && (!currentUser || currentUser.projects.length === 0)">
    <h2>No projects yet</h2>
    <p>Create a new project to get started</p>
  </div>

  <!-- Create Project Modal -->
  <div *ngIf="showCreateModal" class="modal-overlay" (click)="closeCreateModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Create New Project</h2>
        <button class="close-btn" (click)="closeCreateModal()">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Project Name *</label>
          <input 
            type="text" 
            [(ngModel)]="newProjectName" 
            placeholder="Enter project name"
            (keyup.enter)="createProject()"
          >
        </div>
        <div class="form-group">
          <label>Project Type</label>
          <select [(ngModel)]="projectType">
            <option value="local">ğŸ“ Local Project</option>
            <option value="hosted">ğŸŒ Hosted/Shared Project</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="cancel-btn" (click)="closeCreateModal()">Cancel</button>
        <button 
          class="submit-btn" 
          (click)="createProject()"
          [disabled]="!newProjectName.trim() || isSaving"
        >
          <span *ngIf="isSaving" class="spinner-small"></span>
          <span *ngIf="!isSaving">Create</span>
        </button>
      </div>
    </div>
  </div>
</div>